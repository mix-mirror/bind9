#ifndef NTT_H
#define NTT_H

// THIS FILE IS AUTOGENERATED. DO NOT MODIFY MANUALLY.

#include <stdint.h>

#include "const.h"

// do we use a quadratic extension in the NTT?
#define NTT_EXT 1
// number of values in NTT form
#define NTT_SIZE 256

// NTT coefficient type (F_q(x))
#if NTT_EXT
	typedef struct {
		uint16_t c0;
		uint16_t c1;
	} fqx;
#else
	typedef uint16_t fqx;
#endif

// table of powers of an M-th root of unity
static const fqx MTH_ROOTS[] = {
	{1042,0}, {2112,2000}, {3314,3563}, {574,567}, {2520,1730}, {1982,908}, {852,861}, {3550,3300},
	{2608,828}, {2664,282}, {2868,2760}, {2492,971}, {120,493}, {341,3510}, {1084,2966}, {2050,3552},
	{2855,924}, {1484,963}, {977,3100}, {2155,932}, {418,3234}, {216,828}, {2279,216}, {659,2689},
	{1305,3163}, {1900,1260}, {1286,284}, {3392,2977}, {2112,935}, {2081,997}, {2342,3039}, {1126,2149},
	{3119,3125}, {844,1222}, {1964,748}, {1111,3221}, {2562,250}, {1587,1427}, {2152,2708}, {3142,540},
	{1189,1986}, {2521,2025}, {698,1070}, {2729,1656}, {2928,2200}, {3273,1634}, {423,2112}, {2588,323},
	{1687,1428}, {2177,882}, {2346,3354}, {792,2210}, {3198,2257}, {975,1435}, {501,272}, {2654,859},
	{1836,2879}, {2349,1296}, {1920,3296}, {180,1693}, {485,2240}, {3579,954}, {915,9}, {166,1778},
	{985,2356}, {3560,2901}, {1666,428}, {32,3470}, {1809,35}, {838,1499}, {1299,1919}, {2724,1229},
	{2275,581}, {14,1474}, {770,3361}, {3231,258}, {2780,707}, {1770,1290}, {2404,1769}, {1316,2813},
	{671,2135}, {2635,821}, {2257,1661}, {1860,3205}, {2955,2883}, {1293,3212}, {1903,1561}, {2743,2014},
	{2628,36}, {3290,1727}, {87,2491}, {2895,878}, {2387,1264}, {2477,1152}, {3043,2829}, {3199,3381},
	{1327,3046}, {2075,1989}, {2202,2417}, {1838,1929}, {1682,1072}, {173,1345}, {2791,1596}, {2904,1759},
	{2332,611}, {3024,2362}, {3305,1089}, {662,1742}, {217,140}, {624,1024}, {1214,1133}, {2690,2840},
	{2262,388}, {3169,543}, {188,1135}, {874,2144}, {2974,3550}, {56,317}, {537,3511}, {1448,891},
	{2529,2678}, {97,3229}, {1059,1320}, {2702,1066}, {817,1381}, {2658,1303}, {1722,2837}, {276,2672},
	{716,2237}, {2132,464}, {838,2519}, {1622,188}, {2040,224}, {885,1189}, {1852,3186}, {2443,2662},
	{2580,78}, {984,1443}, {707,816}, {2016,3298}, {2550,998}, {199,3503}, {864,2432}, {477,39},
	{1540,31}, {3328,2081}, {2080,261}, {1874,896}, {1273,682}, {2972,2824}, {670,1657}, {2607,2055},
	{1683,1099}, {2626,360}, {2445,1812}, {3139,2635}, {13,3398}, {3533,2816}, {1805,1650}, {1186,1008},
	{3298,780}, {1368,3150}, {3141,2540}, {2304,2408}, {2688,1656}, {3567,3538}, {825,1119}, {2663,3276},
	{2984,83}, {770,3311}, {2618,659}, {2392,2337}, {3454,2033}, {136,561}, {3166,845}, {176,1090},
	{2161,1909}, {2555,1895}, {1598,636}, {2754,1602}, {2932,405}, {2868,2852}, {2760,1953}, {3557,2510},
	{1972,853}, {2964,2179}, {2229,1297}, {1616,697}, {493,3404}, {572,233}, {3497,1646}, {2651,2438},
	{3363,1120}, {1220,277}, {1201,1798}, {2892,474}, {2032,1005}, {3015,1718}, {2181,2636}, {3244,1405},
	{1002,293}, {3019,363}, {721,2475}, {2546,1234}, {2917,2391}, {2481,386}, {3143,309}, {3202,1207},
	{2896,1336}, {20,907}, {746,2366}, {2234,955}, {652,1819}, {221,686}, {184,3317}, {1939,617},
	{1347,3275}, {2248,1480}, {3331,1827}, {674,351}, {2536,1716}, {362,2197}, {3034,225}, {260,1299},
	{165,2111}, {2229,1887}, {2400,1698}, {2205,2085}, {49,1498}, {2312,2285}, {2319,1296}, {2038,2702},
	{1797,1054}, {551,470}, {1684,691}, {2254,3222}, {3023,1877}, {1543,301}, {177,3558}, {2222,1197},
	{1373,2077}, {3319,1857}, {1089,1306}, {2699,1199}, {2961,3193}, {1487,128}, {2552,182}, {3038,2061},
	{2020,2562}, {868,2537}, {1868,351}, {706,2426}, {1216,1115}, {2557,2594}, {438,1734}, {2051,2505},
	{310,2963}, {973,1078}, {1411,1734}, {1568,989}, {1252,1115}, {3132,1157}, {1364,351}, {3405,1046},
	{2584,2562}, {1516,1522}, {849,182}, {1615,3455}, {1012,3193}, {315,2384}, {1188,1306}, {1593,1726},
	{133,2077}, {3419,2386}, {3431,3558}, {1844,3282}, {2266,1877}, {1893,361}, {1208,691}, {1021,3113},
	{732,1054}, {1157,881}, {3551,1296}, {1014,1298}, {2036,1498}, {707,1498}, {3068,1698}, {533,1696},
	{1307,2111}, {1559,2284}, {324,225}, {2559,1386}, {2914,1716}, {1025,3232}, {2008,1827}, {145,2103},
	{2544,3275}, {2556,2966}, {82,3317}, {907,2897}, {1112,1819}, {3189,2628}, {471,2366}, {927,2676},
	{2934,1336}, {826,2376}, {131,309}, {2867,3197}, {1858,2391}, {197,2349}, {387,2475}, {3382,3220},
	{2288,293}, {1066,2178}, {2349,2636}, {1150,1865}, {546,1005}, {3366,3109}, {584,1798}, {1497,3306},
	{2683,1120}, {1506,1145}, {2023,1646}, {805,3350}, {3269,3404}, {2313,2886}, {57,1297}, {1560,1404},
	{758,853}, {2484,1073}, {2453,1953}, {2137,731}, {246,405}, {773,1981}, {1349,636}, {867,1688},
	{3096,1909}, {1266,2493}, {3155,845}, {697,3022}, {1679,2033}, {1146,1246}, {306,659}, {498,272},
	{516,83}, {2356,307}, {1639,1119}, {3522,45}, {2822,1656}, {1129,1175}, {1485,2540}, {935,433},
	{3088,780}, {2194,2575}, {128,1650}, {2766,767}, {172,3398}, {2191,948}, {2909,1812}, {2986,3223},
	{801,1099}, {1079,1528}, {1256,1657}, {2213,759}, {1628,682}, {2770,2687}, {1242,261}, {1826,1502},
	{2012,31}, {516,3544}, {287,2432}, {119,80}, {35,998}, {1731,285}, {2060,816}, {2427,2140},
	{925,78}, {1522,921}, {2128,3186}, {2074,2394}, {1319,224}, {1810,3395}, {226,2519}, {2596,3119},
	{630,2237}, {2948,911}, {2607,2837}, {378,2280}, {1385,1381}, {185,2517}, {1204,1320}, {3326,354},
	{1959,2678}, {2339,2692}, {3118,3511}, {373,3266}, {642,3550}, {3018,1439}, {2260,1135}, {129,3040},
	{933,388}, {1947,743}, {1236,1133}, {1648,2559}, {3226,140}, {2404,1841}, {2772,1089}, {1803,1221},
	{640,611}, {1080,1824}, {2779,1596}, {1518,2238}, {829,1072}, {184,1654}, {2547,2417}, {481,1594},
	{2793,3046}, {2997,202}, {1294,2829}, {46,2431}, {3515,1264}, {190,2705}, {1005,2491}, {1434,1856},
	{919,36}, {1174,1569}, {119,1561}, {922,371}, {1328,2883}, {1482,378}, {3248,1661}, {3456,2762},
	{777,2135}, {546,770}, {2993,1769}, {3060,2293}, {96,707}, {3489,3325}, {3035,3361}, {1488,2109},
	{727,581}, {370,2354}, {365,1919}, {2337,2084}, {1739,35}, {3502,113}, {1489,428}, {2878,682},
	{242,2356}, {1944,1805}, {2659,9}, {950,2629}, {858,2240}, {1873,1890}, {1950,3296}, {62,2287},
	{2451,2879}, {3513,2724}, {2810,272}, {2410,2148}, {1711,2257}, {3002,1373}, {1466,3354}, {3059,2701},
	{468,1428}, {2911,3260}, {1048,2112}, {1324,1949}, {2038,2200}, {802,1927}, {1815,1070}, {963,1558},
	{408,1986}, {99,3043}, {2306,2708}, {3014,2156}, {771,250}, {749,362}, {871,748}, {2066,2361},
	{922,3125}, {3275,1434}, {1785,3039}, {3078,2586}, {536,935}, {2786,606}, {2013,284}, {3160,2323},
	{2698,3163}, {3348,894}, {1088,216}, {1044,2755}, {3514,3234}, {3087,2651}, {3089,3100}, {2447,2620},
	{3387,924}, {2019,31}, {3116,2966}, {268,73}, {2970,493}, {3463,2612}, {1538,2760}, {2946,3301},
	{147,828}, {3267,283}, {1870,861}, {2890,2675}, {2916,1730}, {1141,3016}, {289,3563}, {529,1583},
	{2541,0}, {1471,1583}, {269,20}, {3009,3016}, {1063,1853}, {1601,2675}, {2731,2722}, {33,283},
	{975,2755}, {919,3301}, {715,823}, {1091,2612}, {3463,3090}, {3242,73}, {2499,617}, {1533,31},
	{728,2659}, {2099,2620}, {2606,483}, {1428,2651}, {3165,349}, {3367,2755}, {1304,3367}, {2924,894},
	{2278,420}, {1683,2323}, {2297,3299}, {191,606}, {1471,2648}, {1502,2586}, {1241,544}, {2457,1434},
	{464,458}, {2739,2361}, {1619,2835}, {2472,362}, {1021,3333}, {1996,2156}, {1431,875}, {441,3043},
	{2394,1597}, {1062,1558}, {2885,2513}, {854,1927}, {655,1383}, {310,1949}, {3160,1471}, {995,3260},
	{1896,2155}, {1406,2701}, {1237,229}, {2791,1373}, {385,1326}, {2608,2148}, {3082,3311}, {929,2724},
	{1747,704}, {1234,2287}, {1663,287}, {3403,1890}, {3098,1343}, {4,2629}, {2668,3574}, {3417,1805},
	{2598,1227}, {23,682}, {1917,3155}, {3551,113}, {1774,3548}, {2745,2084}, {2284,1664}, {859,2354},
	{1308,3002}, {3569,2109}, {2813,222}, {352,3325}, {803,2876}, {1813,2293}, {1179,1814}, {2267,770},
	{2912,1448}, {948,2762}, {1326,1922}, {1723,378}, {628,700}, {2290,371}, {1680,2022}, {840,1569},
	{955,3547}, {293,1856}, {3496,1092}, {688,2705}, {1196,2319}, {1106,2431}, {540,754}, {384,202},
	{2256,537}, {1508,1594}, {1381,1166}, {1745,1654}, {1901,2511}, {3410,2238}, {792,1987}, {679,1824},
	{1251,2972}, {559,1221}, {278,2494}, {2921,1841}, {3366,3443}, {2959,2559}, {2369,2450}, {893,743},
	{1321,3195}, {414,3040}, {3395,2448}, {2709,1439}, {609,33}, {3527,3266}, {3046,72}, {2135,2692},
	{1054,905}, {3486,354}, {2524,2263}, {881,2517}, {2766,2202}, {925,2280}, {1861,746}, {3307,911},
	{2867,1346}, {1451,3119}, {2745,1064}, {1961,3395}, {1543,3359}, {2698,2394}, {1731,397}, {1140,921},
	{1003,3505}, {2599,2140}, {2876,2767}, {1567,285}, {1033,2585}, {3384,80}, {2719,1151}, {3106,3544},
	{2043,3552}, {255,1502}, {1503,3322}, {1709,2687}, {2310,2901}, {611,759}, {2913,1926}, {976,1528},
	{1900,2484}, {957,3223}, {1138,1771}, {444,948}, {3570,185}, {50,767}, {1778,1933}, {2397,2575},
	{285,2803}, {2215,433}, {442,1043}, {1279,1175}, {895,1927}, {16,45}, {2758,2464}, {920,307},
	{599,3500}, {2813,272}, {965,2924}, {1191,1246}, {129,1550}, {3447,3022}, {417,2738}, {3407,2493},
	{1422,1674}, {1028,1688}, {1985,2947}, {829,1981}, {651,3178}, {715,731}, {823,1630}, {26,1073},
	{1611,2730}, {619,1404}, {1354,2286}, {1967,2886}, {3090,179}, {3011,3350}, {86,1937}, {932,1145},
	{220,2463}, {2363,3306}, {2382,1785}, {691,3109}, {1551,2578}, {568,1865}, {1402,947}, {339,2178},
	{2581,3290}, {564,3220}, {2862,1108}, {1037,2349}, {666,1192}, {1102,3197}, {440,3274}, {381,2376},
	{687,2247}, {3563,2676}, {2837,1217}, {1349,2628}, {2931,1764}, {3362,2897}, {3399,266}, {1644,2966},
	{2236,308}, {1335,2103}, {252,1756}, {2909,3232}, {1047,1867}, {3221,1386}, {549,3358}, {3323,2284},
	{3418,1472}, {1354,1696}, {1183,1885}, {1378,1498}, {3534,2085}, {1271,1298}, {1264,2287}, {1545,881},
	{1786,2529}, {3032,3113}, {1899,2892}, {1329,361}, {560,1706}, {2040,3282}, {3406,25}, {1361,2386},
	{2210,1506}, {264,1726}, {2494,2277}, {884,2384}, {622,390}, {2096,3455}, {1031,3401}, {545,1522},
	{1563,1021}, {2715,1046}, {1715,3232}, {2877,1157}, {2367,2468}, {1026,989}, {3145,1849}, {1532,1078},
	{3273,620}, {2610,2505}, {2172,1849}, {2015,2594}, {2331,2468}, {451,2426}, {2219,3232}, {178,2537},
	{999,1021}, {2067,2061}, {2734,3401}, {1968,128}, {2571,390}, {3268,1199}, {2395,2277}, {1990,1857},
	{3450,1506}, {164,1197}, {152,25}, {1739,301}, {1317,1706}, {1690,3222}, {2375,2892}, {2562,470},
	{2851,2529}, {2426,2702}, {32,2287}, {2569,2285}, {1547,2085}, {2876,2085}, {515,1885}, {3050,1887},
	{2276,1472}, {2024,1299}, {3259,3358}, {1024,2197}, {669,1867}, {2558,351}, {1575,1756}, {3438,1480},
	{1039,308}, {1027,617}, {3501,266}, {2676,686}, {2471,1764}, {394,955}, {3112,1217}, {2656,907},
	{649,2247}, {2757,1207}, {3452,3274}, {716,386}, {1725,1192}, {3386,1234}, {3196,1108}, {201,363},
	{1295,3290}, {2517,1405}, {1234,947}, {2433,1718}, {3037,2578}, {217,474}, {2999,1785}, {2086,277},
	{900,2463}, {2077,2438}, {1560,1937}, {2778,233}, {314,179}, {1270,697}, {3526,2286}, {2023,2179},
	{2825,2730}, {1099,2510}, {1130,1630}, {1446,2852}, {3337,3178}, {2810,1602}, {2234,2947}, {2716,1895},
	{487,1674}, {2317,1090}, {428,2738}, {2886,561}, {1904,1550}, {2437,2337}, {3277,2924}, {3085,3311},
	{3067,3500}, {1227,3276}, {1944,2464}, {61,3538}, {761,1927}, {2454,2408}, {2098,1043}, {2648,3150},
	{495,2803}, {1389,1008}, {3455,1933}, {817,2816}, {3411,185}, {1392,2635}, {674,1771}, {597,360},
	{2782,2484}, {2504,2055}, {2327,1926}, {1370,2824}, {1955,2901}, {813,896}, {2341,3322}, {1757,2081},
	{1571,3552}, {3067,39}, {3296,1151}, {3464,3503}, {3548,2585}, {1852,3298}, {1523,2767}, {1156,1443},
	{2658,3505}, {2061,2662}, {1455,397}, {1509,1189}, {2264,3359}, {1773,188}, {3357,1064}, {987,464},
	{2953,1346}, {635,2672}, {976,746}, {3205,1303}, {2198,2202}, {3398,1066}, {2379,2263}, {257,3229},
	{1624,905}, {1244,891}, {465,72}, {3210,317}, {2941,33}, {565,2144}, {1323,2448}, {3454,543},
	{2650,3195}, {1636,2840}, {2347,2450}, {1935,1024}, {357,3443}, {1179,1742}, {811,2494}, {1780,2362},
	{2943,2972}, {2503,1759}, {804,1987}, {2065,1345}, {2754,2511}, {3399,1929}, {1036,1166}, {3102,1989},
	{790,537}, {586,3381}, {2289,754}, {3537,1152}, {68,2319}, {3393,878}, {2578,1092}, {2149,1727},
	{2664,3547}, {2409,2014}, {3464,2022}, {2661,3212}, {2255,700}, {2101,3205}, {335,1922}, {127,821},
	{2806,1448}, {3037,2813}, {590,1814}, {523,1290}, {3487,2876}, {94,258}, {548,222}, {2095,1474},
	{2856,3002}, {3213,1229}, {3218,1664}, {1246,1499}, {1844,3548}, {81,3470}, {2094,3155}, {705,2901},
	{3341,1227}, {1639,1778}, {924,3574}, {2633,954}, {2725,1343}, {1710,1693}, {1633,287}, {3521,1296},
	{1132,704}, {70,859}, {773,3311}, {1173,1435}, {1872,1326}, {581,2210}, {2117,229}, {524,882},
	{3115,2155}, {672,323}, {2535,1471}, {2259,1634}, {1545,1383}, {2781,1656}, {1768,2513}, {2620,2025},
	{3175,1597}, {3484,540}, {1277,875}, {569,1427}, {2812,3333}, {2834,3221}, {2712,2835}, {1517,1222},
	{2661,458}, {308,2149}, {1798,544}, {505,997}, {3047,2648}, {797,2977}, {1570,3299}, {423,1260},
	{885,420}, {235,2689}, {2495,3367}, {2539,828}, {69,349}, {496,932}, {494,483}, {1136,963},
	{196,2659}, {1564,3552}, {467,617}, {3315,3510}, {613,3090}, {120,971}, {2045,823}, {637,282},
	{3436,2755}, {316,3300}, {1713,2722}, {693,908}, {667,1853}, {2442,567}, {3294,20}, {3054,2000}
};

// ROOT_IDX[i*D/d] is the index in MTH_ROOT to use at index i in NTT of dimension d
// ROOT_IDX[k] = prim_pow[digit_rev(k, D//ext) * ext]
// this permutation is necessary to perform the NTT in-place
static const int ROOT_IDX[] = {
	1, 513, 257, 769, 129, 641, 385, 897,
	65, 577, 321, 833, 193, 705, 449, 961,
	33, 545, 289, 801, 161, 673, 417, 929,
	97, 609, 353, 865, 225, 737, 481, 993,
	17, 529, 273, 785, 145, 657, 401, 913,
	81, 593, 337, 849, 209, 721, 465, 977,
	49, 561, 305, 817, 177, 689, 433, 945,
	113, 625, 369, 881, 241, 753, 497, 1009,
	9, 521, 265, 777, 137, 649, 393, 905,
	73, 585, 329, 841, 201, 713, 457, 969,
	41, 553, 297, 809, 169, 681, 425, 937,
	105, 617, 361, 873, 233, 745, 489, 1001,
	25, 537, 281, 793, 153, 665, 409, 921,
	89, 601, 345, 857, 217, 729, 473, 985,
	57, 569, 313, 825, 185, 697, 441, 953,
	121, 633, 377, 889, 249, 761, 505, 1017,
	5, 517, 261, 773, 133, 645, 389, 901,
	69, 581, 325, 837, 197, 709, 453, 965,
	37, 549, 293, 805, 165, 677, 421, 933,
	101, 613, 357, 869, 229, 741, 485, 997,
	21, 533, 277, 789, 149, 661, 405, 917,
	85, 597, 341, 853, 213, 725, 469, 981,
	53, 565, 309, 821, 181, 693, 437, 949,
	117, 629, 373, 885, 245, 757, 501, 1013,
	13, 525, 269, 781, 141, 653, 397, 909,
	77, 589, 333, 845, 205, 717, 461, 973,
	45, 557, 301, 813, 173, 685, 429, 941,
	109, 621, 365, 877, 237, 749, 493, 1005,
	29, 541, 285, 797, 157, 669, 413, 925,
	93, 605, 349, 861, 221, 733, 477, 989,
	61, 573, 317, 829, 189, 701, 445, 957,
	125, 637, 381, 893, 253, 765, 509, 1021
};

// used in modular arithmetic routines:
#define R2 115 // 2^32 % q
#define M_INV_Q 3585 // -1/q mod 2^16

// 1/(j-j^2) with j a cubic root of unity
// used in inverse NTT in ternary case
static const fqx INV_ROOT_DIFF = {3428,310};

// additive chain used for quick exponentiation in inversion routine
static const int INV_CHAIN[] = {0, 0, 0, 0, 3, 5, 6, 7, 4, 8, 10, 10, 12, 13, 14, 4};
#define INV_CHAIN_LEN 17

// coefficients of defining polynomial for quadratic extension
#define EXT_REM0 3126
#define EXT_REM1 2541
// coefficients of conjugate of quadratic extension generator
#define EXT_CONJ0 1042
#define EXT_CONJ1 2541

#endif
